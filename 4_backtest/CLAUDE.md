# 4_backtest - 전체 파이프라인 백테스트

예측 파이프라인 백테스트 (1_firstend → 2_146 → 3_235)

## 실행

```bash
# 범위 백테스트
python 4_backtest/backtest_full.py --start 900 --end 1000

# 단일 회차
python 4_backtest/backtest_full.py --round 1205
```

## 파이프라인

1. **데이터 로드**: 목표 회차 직전까지만 학습 데이터로 사용
2. **1_firstend**: (ord1, ord6) 쌍 빈도 계산 - 50/50 전략 (seen 상위 50% + unseen 상위 50%)
3. **2_146**: ord4 계산 (공식 A × 0.60 + ±7 오프셋)
4. **3_235**: ord2, ord3, ord5 채우기 (점수화, Top-3 seen + Top-2 unseen)
5. **비교**: 당첨번호와 일치 개수 계산

## 점수화 기준 (3_235)

| 요소 | 점수 |
|------|------|
| seen 빈도 | ×10 |
| unseen 빈도 | ×2 |
| 최빈 구간 (seen) | +15 |
| 최빈 구간 (unseen) | +20 |
| 핫 비트 | +5 |
| 콜드 비트 | -3 |
| 최근 3회 | -5 |
| 소수 | +3 |

## 포지션별 최빈 구간

| 포지션 | 최빈 구간 | 적중률 |
|--------|-----------|--------|
| ord2 | 10-19 | 48.3% |
| ord3 | 10-19 | 45.4% |
| ord5 | 30-39 | 54.6% |

## 핫/콜드 비트

- **핫 비트**: 29, 17, 27, 3, 25, 1, 19, 39, 4, 31
- **콜드 비트**: 41, 43, 8, 14, 34, 26, 22, 44, 20, 7

## 출력

결과 파일: `result/backtest_{start}_{end}_{timestamp}.csv`

| 컬럼 | 설명 |
|------|------|
| round | 회차 |
| ord1~ord6 | 예측 번호 |
| winning | 당첨 번호 |
| match_count | 일치 개수 |
| matched_nums | 일치 번호 |

## 참고

- main.py에서 단일 회차 예측 및 검증 가능
- 인사이트 폴더: 2_insights/ (1~8번)
